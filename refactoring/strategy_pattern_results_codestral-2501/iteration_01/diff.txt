--- backup/utilities\schema\classes\Relationship.cls
+++ refactored/utilities\schema\classes\Relationship.cls
@@ -9 +9 @@
-publicstaticRelationshipfromRefrenceField(StringreferenceFieldName){
+publicstaticRelationshipfromReferenceField(StringreferenceFieldName){
@@ -18,8 +18,2 @@
-publicstaticRelationshipfromIdField(StringidFieldName){
-StringreferenceFieldName;
-if(idFieldName.toLowerCase().endsWith('__c')){
-referenceFieldName=idFieldName.replaceAll('(?i)__c','__r');
-}elseif(idFieldName.toLowerCase().endsWith('id')){
-referenceFieldName=idFieldName.replaceAll('(?i)id','');
-}else{
-thrownewInvalidFieldException(INVALID_RELATIONSHIP_FIELD+idFieldName);
+privateinterfaceIdFieldStrategy{
+RelationshipcreateRelationship(StringidFieldName);
@@ -26,0 +21,3 @@
+privatestaticclassCustomFieldStrategyimplementsIdFieldStrategy{
+publicRelationshipcreateRelationship(StringidFieldName){
+StringreferenceFieldName=idFieldName.replaceAll('(?i)__c','__r');
@@ -29,0 +27,25 @@
+privatestaticclassStandardFieldStrategyimplementsIdFieldStrategy{
+publicRelationshipcreateRelationship(StringidFieldName){
+StringreferenceFieldName=idFieldName.replaceAll('(?i)id','');
+returnnewRelationship(referenceFieldName,idFieldName);
+}
+}
+privatestaticclassInvalidFieldStrategyimplementsIdFieldStrategy{
+publicRelationshipcreateRelationship(StringidFieldName){
+thrownewInvalidFieldException(INVALID_RELATIONSHIP_FIELD+idFieldName);
+}
+}
+privatestaticfinalMap<String,IdFieldStrategy>STRATEGIES=newMap<String,IdFieldStrategy>{
+'__c'=>newCustomFieldStrategy(),
+'id'=>newStandardFieldStrategy()
+};
+publicstaticRelationshipfromIdField(StringidFieldName){
+StringstrategyKey=idFieldName.toLowerCase().endsWith('__c')?'__c':
+idFieldName.toLowerCase().endsWith('id')?'id':null;
+IdFieldStrategystrategy=STRATEGIES.get(strategyKey);
+if(strategy!=null){
+returnstrategy.createRelationship(idFieldName);
+}
+returnnewInvalidFieldStrategy().createRelationship(idFieldName);
+}
+}